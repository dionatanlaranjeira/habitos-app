---
description: Convenções de código Dart/Flutter - nomenclatura, DTOs, barrel files
globs: lib/**/*.dart
alwaysApply: false
---

# Convenções de Código

## Nomenclatura

- Arquivos: `snake_case` (ex: `splash_controller.dart`)
- Classes: `PascalCase` (ex: `SplashController`)
- Variáveis/funções: `camelCase`
- Constantes de storage: `UPPER_SNAKE_CASE` (ex: `ACCESS_TOKEN`)

## Barrel Files (Obrigatório)

Cada subpasta tem arquivo de exportação (`controllers.dart`, `models.dart`, etc.):

```dart
// ✅ Correto
import '../../global_modules/global_modules.dart';
import 'controllers/controllers.dart';

// ❌ Errado — importar arquivo direto
import '../../global_modules/user/stores/user_store.dart';
```

## DTOs com Freezed

```dart
@freezed
class LoginResponseDto with _$LoginResponseDto {
  const factory LoginResponseDto({
    required String token,
    required String refreshToken,
  }) = _LoginResponseDto;

  factory LoginResponseDto.fromJson(Map<String, dynamic> json) =>
      _$LoginResponseDtoFromJson(json);
}

// Mapper obrigatório: DTO → Model
extension LoginResponseDtoMapper on LoginResponseDto {
  LoginModel toDomain() => LoginModel(token: token, refreshToken: refreshToken);
}
```

Rodar code generation: `dart run build_runner build --delete-conflicting-outputs`

## Repositories — Interface + Implementação

```dart
abstract class LoginRepository {
  Future<LoginModel> login(LoginRequestDto dto);
}

class LoginRepositoryImpl implements LoginRepository {
  final HttpAdapter _httpAdapter;
  LoginRepositoryImpl({required HttpAdapter httpAdapter}) : _httpAdapter = httpAdapter;
  // ...
}
```

## Pages — StatelessWidget

Views devem ser `StatelessWidget`. Estado fica no Controller (Signals).

## Controllers — Com Mixin de Variáveis

```dart
mixin LoginVariables {
  final loginAS = asyncSignal<AuthModel>(AsyncLoading());
  final cpfController = TextEditingController();
}

class LoginController with LoginVariables {
  final AuthRepository _repository;
  LoginController(this._repository);
}
```
